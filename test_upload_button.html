<!DOCTYPE html>
<html>
<head>
    <title>Teste Bot√£o Upload For√ßado</title>
    <meta charset="UTF-8">
    <style>
        body {
            background: #1a1a2e;
            color: white;
            font-family: 'Segoe UI', Arial;
            padding: 40px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: #16213e;
            padding: 30px;
            border-radius: 10px;
            border: 1px solid #0f3460;
        }
        h1 {
            color: #4CAF50;
            margin-bottom: 30px;
        }
        .test-section {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        button {
            background: #2196F3;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
        }
        button:hover {
            background: #1976D2;
        }
        .status {
            margin-top: 20px;
            padding: 15px;
            background: rgba(76, 175, 80, 0.2);
            border-radius: 5px;
            display: none;
        }
        .error {
            background: rgba(244, 67, 54, 0.2);
            color: #F44336;
        }
        .success {
            background: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
        }
        code {
            background: rgba(255, 255, 255, 0.1);
            padding: 2px 5px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Teste do Bot√£o de Upload For√ßado</h1>

        <div class="test-section">
            <h2>Canais de Teste</h2>
            <p>Clique em um dos bot√µes abaixo para testar o upload for√ßado:</p>

            <button onclick="testarUpload('UCRdBaJB3P1bObo_JQsnDdjA', 'I Segreti del Trono')">
                üì§ I Segreti del Trono
            </button>

            <button onclick="testarUpload('UCy2XU6qY3CzrqJ5DZm-UbLA', 'Historic Shadows')">
                üì§ Historic Shadows
            </button>

            <button onclick="testarUpload('UCefJr_1K4fMP25LzGxdbF2A', 'Grandes Mans√µes')">
                üì§ Grandes Mans√µes
            </button>
        </div>

        <div class="test-section">
            <h2>Status da Requisi√ß√£o</h2>
            <div id="status" class="status"></div>
        </div>

        <div class="test-section">
            <h2>Como funciona:</h2>
            <ol>
                <li>Clicar no bot√£o mostra confirma√ß√£o</li>
                <li>Se confirmar, faz POST para <code>http://localhost:8000/api/yt-upload/force/{channel_id}</code></li>
                <li>O endpoint inicia o processo de upload em background</li>
                <li>O dashboard atualiza automaticamente quando conclu√≠do</li>
            </ol>
        </div>
    </div>

    <script>
        async function testarUpload(channelId, channelName) {
            const statusDiv = document.getElementById('status');

            if (!confirm('For√ßar upload do canal ' + channelName + '?\n\nO pr√≥ximo v√≠deo "done" da planilha ser√° enviado.')) {
                statusDiv.className = 'status error';
                statusDiv.style.display = 'block';
                statusDiv.innerHTML = '‚ùå Upload cancelado pelo usu√°rio';
                return;
            }

            statusDiv.className = 'status';
            statusDiv.style.display = 'block';
            statusDiv.innerHTML = '‚è≥ Enviando requisi√ß√£o para o servidor...';

            try {
                const response = await fetch('http://localhost:8000/api/yt-upload/force/' + channelId, {
                    method: 'POST'
                });

                const result = await response.json();

                if (response.ok) {
                    statusDiv.className = 'status success';
                    statusDiv.innerHTML = `
                        ‚úÖ <strong>Sucesso!</strong><br>
                        ${result.message}<br>
                        <br>
                        <strong>Canal:</strong> ${channelName}<br>
                        <strong>Channel ID:</strong> ${channelId}<br>
                        <strong>Status HTTP:</strong> ${response.status}<br>
                        <br>
                        <em>Acompanhe o progresso no dashboard em http://localhost:5006</em>
                    `;
                } else {
                    statusDiv.className = 'status error';
                    statusDiv.innerHTML = `
                        ‚ùå <strong>Erro!</strong><br>
                        ${result.detail || 'Falha ao iniciar upload'}<br>
                        <br>
                        <strong>Status HTTP:</strong> ${response.status}<br>
                        <strong>Canal:</strong> ${channelName}
                    `;
                }
            } catch (error) {
                statusDiv.className = 'status error';
                statusDiv.innerHTML = `
                    ‚ùå <strong>Erro de conex√£o!</strong><br>
                    ${error.message}<br>
                    <br>
                    Verifique se o servidor FastAPI est√° rodando em http://localhost:8000
                `;
            }
        }
    </script>
</body>
</html>